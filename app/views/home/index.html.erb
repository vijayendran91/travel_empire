<%= render :partial => 'home/navbar_files/navbar'%>
<center>
  <div id="formContainer" class="shadow-lg p-3 mb-5 bg-white rounded">

    <div id="initBtnCntnr">
      <div class="form-row mt-4">
        <div class="form-group col-md-6">
          <button type="button" id="bookCab" name="button" class="btn green-btn ">Book a Cab</button>
        </div>
        <div class="form-group col-md-6">
          <%= link_to "Make a Payment", "https://pmny.in/aIlQzaGFxaIb",:id => "makePayment", :class=> "btn green-btn"%>
        </div>
      </div>
    </div>
    <%=render :partial => 'home/cab_booking/tot_modal.html.erb'%>
    <%=@trip.fname%>
    <%= form_for(@trip,:as => 'trip', url: submit_trip_path(@trip)) do |f| %>
      <%=render :partial => 'home/cab_booking/per_bus', :locals => {:f => f}%>
      <%=render :partial => 'home/cab_booking/cab_booking_form', :locals => {:f => f}%>
      <%=f.submit "Book Ride", :class=>"btn ml-3 green-btn form-submit"%>
    <%end%>
  </div>
</center>
<script type="text/javascript" src="data/districts.json"></script>
<script>
  let porb = "";
  let tor = "";
  let locs = 0;
  let dist = JSON.stringify(districts);
  districts_data = JSON.parse(dist)["data"];
  $(document).ready(function(){
    $('#totModal').hide();
    $('.perOrBus').hide();
    $('#addLocation').hide();
    $('#bookCab').on('click', function(){
        $('#bookCab').hide();
        $('#makePayment').hide();
        $('.perOrBus').show();
      // $('.cabBookingForm').show();
    });

    $('#personalRadio').on('click',function(){
      $('#gst').hide();
      $('#gstLabel').hide();
      $('.cabBookingForm').show();
    });

    $('#businessRadio').on('click',function(){
      $('#gst').show();
      $('#gstLabel').show();
      $('.cabBookingForm').show();
    });

    function showModal(tor){
      $('#totModal').on('show.bs.modal', function(event){
          console.log(tor);
          var modal = $(this);
          var insertList = "";
          switch(tor){
            case "ow":
                  insertList = "<ul><li>Your Journey Starts at Zero Km. and ends at one Destination Only (End or Drop Point). No returning Back again.</li><li>Waiting Charges Apply.</li><li>Billing Charges - Minimum 130 Kms.</li><li>Driver Bata Rs.500/- Govt. & Private Toll Entry Fee & Permit Fee Excluded.</li></ul>"
              break; 
          }
  
          modal.find('.modal-body-text').append(insertList);
      });
      $('#totModal').modal('show');  
    }


    $( "#inlineFormCustomSelect" ).change(function() {
      tor =  $(this).val();
      console.log(tor+" 1");
      switch(tor){
          case "ow":
              showModal(tor);
              $('#addLocation').hide();
              $('#toDistSelect').show();
              $('#locationSwap').show();
              $('#toAreaLabel').show();
              $('#toDistLabel').show();
              $('#toArea').show();
              $('.locations').hide();
              $('#totModal').show();
              break;
          case "rtt":
              $('#addLocation').hide();
              $('#toDistSelect').show();
              $('#toAreaLabel').show();
              $('#locationSwap').show();
              $('.locations').hide();
              $('#toDistLabel').show();
              $('#toArea').show();
              break;
          case "rt":
              $('.locations').show();
              $('#addLocation').show();
              $('#locationSwap').hide();
              $('#toDistSelect').hide();
              $('#toDistLabel').hide();
              $('#toAreaLabel').hide();
              $('#toArea').hide();
              break;
          case "my":
              $('.locations').show();
              $('#addLocation').show();
              $('#locationSwap').hide();
              $('#toDistSelect').hide();
              $('#toAreaLabel').hide();
              $('#toDistLabel').hide();
              $('#toArea').hide();
              break;
          case "hy":
              $('.locations').hide();
              $('#addLocation').hide();
              $('#locationSwap').hide();
              $('#toDistSelect').hide();
              $('#toAreaLabel').hide();
              $('#toDistLabel').hide();
              $('#toArea').hide();
              break;
        location.reload();
      }
    });

    $('#addLocation').on('click',function(){
      locs++;
      if(locs<5){
        parElem = document.getElementById('multiLocations');
        input = document.createElement("input");
        input.setAttribute('type','text');
        input.setAttribute('class',"form-control mb-3 locations");
        parElem.appendChild(input);
      }else{
        window.alert("You can add only maximum of 4 locations");
      }
    });

    for(let i=0; i<districts_data.length;i++){
      $("#fromDistSelect").append('<option value="'+districts_data[i]+'">' + districts_data[i] + '</option>');
      $("#toDistSelect").append('<option value="'+districts_data[i]+'">' + districts_data[i] + '</option>');
    }

  });
</script>
